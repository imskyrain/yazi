# Yazi 使用手册

> 基于当前配置（备份版 keymap），键映射为自定义 `u/e/n` 体系。

---

## 一、基础使用

### 1.1 启动与退出

| 操作 | 键 |
|:---|:---|
| 启动 yazi | 终端输入 `yazi` |
| 退出（关闭当前 tab，末 tab 时退出） | `q` |
| 强制退出（不写入 cwd） | `Q` |
| 暂停到后台 | `<C-z>` |

### 1.2 基础导航

这套配置**不使用** `hjkl`，导航键映射如下：

| 方向 | 单键 | 说明 |
|:---|:---|:---|
| 上 | `u` | 光标上移一行 |
| 下 | `e` | 光标下移一行 |
| 进入子目录 | `<Right>` / `i`(smart-enter) | 文件夹进入，文件直接打开 |
| 返回父目录 | `n` / `<Left>` | 上一级 |
| 历史后退 | `N` | 回到上一个访问的目录 |
| 历史前进 | `I` | 回到下一个访问的目录 |

**快速滚动：**

| 键 | 行为 |
|:---|:---|
| `U` / `E` | 上/下 5 行 |
| `<C-u>` / `<C-e>` | 半页上/下 |
| `<PageUp>` / `<PageDown>` | 全页上/下 |
| `gg` | 跳到列表顶端 |
| `G` | 跳到列表底端 |

### 1.3 文件选择

| 键 | 行为 |
|:---|:---|
| `<Space>` | 选中当前文件并下移 |
| `v` | 进入 visual 选择模式（拖拽选多个） |
| `V` | 进入 visual unset 模式（拖拽取消选择） |

### 1.4 文件操作（复制/剪切/粘贴）

| 键 | 行为 |
|:---|:---|
| `yy` | 复制（yank）选中文件 |
| `dd` | 剪切（cut）选中文件 |
| `pp` | 粘贴到当前目录 |
| `pP` | 粘贴并覆盖同名文件 |
| `pl` | 创建绝对路径软链接 |
| `pL` | 创建相对路径软链接 |
| `ph` | 创建硬链接 |
| `yc` | 取消 yank 状态 |

**复制路径信息：**

| 键 | 复制内容 |
|:---|:---|
| `yp` | 完整文件路径 |
| `yd` | 所在目录路径 |
| `yf` | 文件名（含扩展名） |
| `yn` | 文件名（不含扩展名） |

### 1.5 删除与重命名

| 键 | 行为 |
|:---|:---|
| `dD` | 永久删除（不可恢复） |
| `k` | 重命名，光标在文件名开头 |
| `a` | 重命名，光标在扩展名前 |
| `A` | 重命名，光标在末尾 |
| `cw` | 重命名，清空当前名称 |

### 1.6 创建文件/目录

| 键 | 行为 |
|:---|:---|
| `T` | 创建文件（输入名末尾加 `/` 则创建目录） |
| `M` | 直接创建目录 |

### 1.7 打开与预览

| 键 | 行为 |
|:---|:---|
| `i` / `<Enter>` | smart-enter：文件夹进入，文件用默认程序打开 |
| `r` | 选择程序打开（interactive） |
| `P` | 打开 spotter（全屏预览浮窗） |

### 1.8 查找与过滤

| 键 | 行为 |
|:---|:---|
| `f` | 过滤文件列表（实时筛选） |
| `/` | 查找下一个文件 |
| `?` | 查找上一个文件 |
| `F` | 用 ripgrep 搜索文件内容 |
| `<C-p>` | 用 fzf 跳转到任意目录/文件 |
| `<C-s>` | 取消当前搜索 |

### 1.9 排序

排序前缀键为 `o`，按需切换：

| 键 | 排序方式 | 同时切换 linemode |
|:---|:---|:---|
| `oM` / `om` | 修改时间（正序/逆序） | mtime |
| `oC` / `oc` | 创建时间（正序/逆序） | btime |
| `oE` / `oe` | 扩展名（正序/逆序） | — |
| `oa` / `oA` | 字母序（正序/逆序） | — |
| `on` / `oN` | 自然序（正序/逆序） | — |
| `os` / `oS` | 文件大小（正序/逆序） | size |

### 1.10 切换显示信息（linemode）

前缀键 `m`：

| 键 | 显示内容 |
|:---|:---|
| `ms` | 文件大小 |
| `mp` | 权限（rwx） |
| `mc` | 创建时间 |
| `mm` | 修改时间 |
| `mo` | 文件所有者 |
| `mn` | 不显示 |

### 1.11 隐藏文件与刷新

| 键 | 行为 |
|:---|:---|
| `zh` | 切换隐藏文件显示 |
| `R` | 刷新当前目录 |

### 1.12 Shell 与外部工具

| 键 | 行为 |
|:---|:---|
| `S` | 在当前目录打开 Shell（阻塞） |
| `;` | 交互式执行命令（不阻塞） |
| `:` | 交互式执行命令（阻塞，等待完成） |
| `<C-g>` | 启动 lazygit |

### 1.13 Tab 管理

| 键 | 行为 |
|:---|:---|
| `tu` | 在当前目录新开 tab |
| `tn` / `ti` | 切换到上一个/下一个 tab |
| `1`~`9` | 直接跳到第 N 个 tab |

### 1.14 Goto 快跳

| 键 | 目标路径 |
|:---|:---|
| `gr` | `/`（根目录） |
| `gh` | `~`（家目录） |
| `gc` | `~/.config` |
| `gd` | `~/Downloads` |
| `gD` | `~/Desktop` |
| `gi` | `~/Github` |
| `gff` | `~/.config`（冗余但保留） |
| `gfn` | `~/.config/nvim` |
| `gfy` | `~/.config/yazi` |
| `gfz` | `~/.config/zsh` |
| `gfl` | `~/.config/jesseduffield/lazygit` |
| `gF` | `~/.sconfig` |
| `g<Space>` | 交互式 cd（带补全） |

### 1.15 帮助

| 键 | 行为 |
|:---|:---|
| `~` / `<F1>` | 打开帮助页（可用 `f` 过滤） |
| `w` | 打开任务管理器 |

---

## 二、插件增强功能

当前配置加载了 6 个插件，本节介绍插件带来的全部增强能力。

### 2.1 smart-enter — 智能进入

**绑定：** `i` / `<Enter>`

标准 Enter 键行为分叉：
- 悬停在**文件夹**上 → 进入该文件夹
- 悬停在**文件**上 → 用默认程序打开该文件

省免了手动在"进入"和"打开"之间判断。

### 2.2 yamb — 书签管理（fzf 驱动）

**绑定：** `'` 为前缀

| 键 | 行为 |
|:---|:---|
| `'a` | 将当前悬停项添加为书签（弹窗输入 tag 和快捷键） |
| `''` | 用 fzf 选择书签并跳转 |
| `'r` | 用 which 菜单选择书签并删除 |

**工作流：**
1. 浏览到常用目录，悬停在目录名上
2. `'a` → 输入一个 tag（别名），如 `proj`
3. 可选输入一个单字母快捷键（如 `p`）
4. 之后随时 `''` 打开 fzf，搜索 `proj` 即可跳转

书签数据存储在 `~/.config/yazi/bookmark`。

### 2.3 compress — 一键压缩归档

**绑定：** `ca`

支持的格式：`zip`, `7z`, `rar`, `tar.gz`, `tar.xz`, `tar.bz2`, `tar.zst`, `tar.lz4`, `tar.lha`, `tar`

**工作流：**
1. 选中文件（`<Space>` 多选）
2. `ca` → 弹出输入框，键入归档文件名（如 `backup.zip`）
3. 不写扩展名则自动附加 `.zip`
4. 插件自动检测系统上可用的压缩工具并执行

**高级参数（绑定时可追加）：**

| 参数 | 含义 |
|:---|:---|
| `-p` | 创建时设置密码 |
| `-h` | 加密文件头（7z/rar 支持） |
| `-l` | 手动指定压缩级别 |

例如：若将绑定改为 `plugin compress -p`，则每次压缩都会提示输入密码。

### 2.4 git — Git 状态显示

**配置：** `init.lua` 中 `require("git"):setup {}`

在文件列表右侧自动追加 git 状态标记：

| 标记 | 含义 |
|:---|:---|
| `? ` | Untracked（未追踪） |
| ` ` | Modified（已修改） |
| ` ` | Added（已暂存） |
| ` ` | Deleted（已删除） |
| ` ` | Updated（合并冲突已解决） |

对文件夹会**向上冒泡**：只要子目录内有任何变更，父目录也会显示对应状态（取优先级最高的）。

### 2.5 starship — 提示词集分

**配置：** `init.lua` 中指定 `~/.config/yazi/starship.toml`

在 yazi 的 Header 区域替换默认路径显示为 Starship 提示词，支持：
- 当前 git 分支、dirty 状态
- 语言版本（因 starship.toml 禁用了 aws/gcloud/lua，保持简洁）

### 2.6 yaziline — 自定义状态栏

**配置：** `init.lua` 中设置为 curvy 分隔符风格

状态栏信息组成（左→右）：

| 区域 | 内容 |
|:---|:---|
| 左端 | 当前模式（NORMAL / SELECT） + 分隔符 |
| 左侧 | 选中文件数 + yank 文件数 |
| 右侧 | 当前文件修改时间 |
| 右端 | 滚动百分比 + 当前行/总行数 |

状态栏还通过 `init.lua` 中的自定义组件在右侧追加了**文件所有者:组**信息（Unix 专属）。

---

## 三、任务管理

按 `w` 打开任务管理器，可查看后台复制/移动/预加载任务的进度。

| 键（任务管理器内） | 行为 |
|:---|:---|
| `<Enter>` | 查看任务详情 |
| `x` | 取消该任务 |
| `w` / `<Esc>` | 关闭任务管理器 |

---

## 四、配置文件索引

| 文件 | 用途 |
|:---|:---|
| `yazi.toml` | 核心配置（布局/预览/任务/插件规则） |
| `keymap.toml` | 全部键映射 |
| `theme.toml` | 主题样式（本备份为极简版，在用版为完整版） |
| `init.lua` | 插件初始化 + 状态栏自定义 |
| `package.toml` | 插件版本锁定 |
| `starship.toml` | Starship 在 yazi 内的提示词配置 |
| `plugins/` | 6 个插件源码 |
